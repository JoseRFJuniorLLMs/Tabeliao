# =============================================================================
# Tabeliao - API Gateway
# Central entry point: routing, authentication, rate limiting, request validation
# =============================================================================

# -----------------------------------------------------------------------------
# Service
# -----------------------------------------------------------------------------
NODE_ENV=development
APP_PORT=3000
SERVICE_NAME=api-gateway

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# Stores: API keys, rate limit counters (persistent), audit logs
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://tabeliao:tabeliao_dev_2026@localhost:5432/tabeliao_db
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=tabeliao
DATABASE_PASSWORD=tabeliao_dev_2026
DATABASE_NAME=tabeliao_db
DATABASE_SCHEMA=gateway

# -----------------------------------------------------------------------------
# Redis (Session, Cache & Rate Limiting)
# Used for: session store, JWT blacklist, request rate limiting, response cache
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379

# -----------------------------------------------------------------------------
# RabbitMQ (Message Broker)
# Used for: async request forwarding, event publishing
# -----------------------------------------------------------------------------
RABBITMQ_URL=amqp://tabeliao:tabeliao_dev_2026@localhost:5672

# -----------------------------------------------------------------------------
# JWT Authentication
# Must match across all services that validate tokens
# -----------------------------------------------------------------------------
JWT_SECRET=your-jwt-secret-change-in-production
JWT_EXPIRES_IN=15m
JWT_REFRESH_SECRET=your-refresh-secret-change-in-production
JWT_REFRESH_EXPIRES_IN=7d

# -----------------------------------------------------------------------------
# Service Discovery (Internal URLs)
# In Docker Compose, services are reached via container names
# In development (local), services run on different ports
# -----------------------------------------------------------------------------
AUTH_SERVICE_URL=http://localhost:3001
CONTRACT_SERVICE_URL=http://localhost:3002
AI_SERVICE_URL=http://localhost:3003
BLOCKCHAIN_SERVICE_URL=http://localhost:3004
PAYMENT_SERVICE_URL=http://localhost:3005
NOTIFICATION_SERVICE_URL=http://localhost:3006
DISPUTE_SERVICE_URL=http://localhost:3007

# -----------------------------------------------------------------------------
# CORS Configuration
# Comma-separated list of allowed origins
# -----------------------------------------------------------------------------
CORS_ORIGINS=http://localhost:3000,http://localhost:4000

# -----------------------------------------------------------------------------
# Rate Limiting (Global)
# Requests per window per IP
# -----------------------------------------------------------------------------
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# -----------------------------------------------------------------------------
# Request Configuration
# -----------------------------------------------------------------------------
# Max request body size
MAX_BODY_SIZE=10mb

# Request timeout (ms) for upstream service calls
UPSTREAM_TIMEOUT=30000

# -----------------------------------------------------------------------------
# Sentry (Error Tracking)
# -----------------------------------------------------------------------------
SENTRY_DSN=

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=debug
