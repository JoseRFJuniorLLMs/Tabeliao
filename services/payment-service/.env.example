# =============================================================================
# Tabeliao - Payment Service
# Handles PIX payments, Stripe card payments, invoicing, and escrow releases
# =============================================================================

# -----------------------------------------------------------------------------
# Service
# -----------------------------------------------------------------------------
NODE_ENV=development
APP_PORT=3005
SERVICE_NAME=payment-service

# -----------------------------------------------------------------------------
# Database (PostgreSQL)
# Stores: transactions, invoices, payment status, escrow ledger
# -----------------------------------------------------------------------------
DATABASE_URL=postgresql://tabeliao:tabeliao_dev_2026@localhost:5432/tabeliao_db
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_USER=tabeliao
DATABASE_PASSWORD=tabeliao_dev_2026
DATABASE_NAME=tabeliao_db
DATABASE_SCHEMA=payment

# -----------------------------------------------------------------------------
# Redis (Caching & Idempotency)
# Used for: idempotency keys, payment status cache, webhook dedup
# -----------------------------------------------------------------------------
REDIS_URL=redis://localhost:6379
REDIS_HOST=localhost
REDIS_PORT=6379

# -----------------------------------------------------------------------------
# RabbitMQ (Message Broker)
# Queues: payment.process, payment.refund, escrow.release
# Publishes: payment.completed, payment.failed, escrow.released
# Consumes: contract.completed (trigger escrow release)
# -----------------------------------------------------------------------------
RABBITMQ_URL=amqp://tabeliao:tabeliao_dev_2026@localhost:5672

# -----------------------------------------------------------------------------
# PIX (EfiPay / Open Finance)
# Homologation environment for development
# Docs: https://dev.efipay.com.br/docs/api-pix
# Certificates must be generated at: https://app.efipay.com.br
# -----------------------------------------------------------------------------
PIX_CLIENT_ID=
PIX_CLIENT_SECRET=
PIX_CERT_PATH=./certs/pix-cert.pem
PIX_KEY_PATH=./certs/pix-key.pem
PIX_API_URL=https://pix-h.api.efipay.com.br
PIX_WEBHOOK_URL=http://localhost:3005/api/v1/payments/pix/webhook

# PIX key for receiving payments (CPF, CNPJ, email, phone, or random)
PIX_KEY=

# QR Code expiration in seconds (default: 3600 = 1 hour)
PIX_QR_EXPIRATION=3600

# -----------------------------------------------------------------------------
# Stripe (Credit/Debit Card Payments)
# Use test keys for development (sk_test_*, pk_test_*)
# Dashboard: https://dashboard.stripe.com/test
# Webhook CLI: stripe listen --forward-to localhost:3005/api/v1/payments/stripe/webhook
# -----------------------------------------------------------------------------
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PUBLISHABLE_KEY=

# -----------------------------------------------------------------------------
# Logging
# -----------------------------------------------------------------------------
LOG_LEVEL=debug
